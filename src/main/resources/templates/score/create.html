<!DOCTYPE html>
<html layout:decorate="~{layout}"> <!-- layout.html 상속 -->
<div layout:fragment="content">
  <div class='title_line'>
    평점 주기
  </div>
  
  <aside class="aside_right">
    <a th:href="@{.|/create?scoreno=${scoreVO.scoreno}|}">등록</a>
    <span class='menu_divide'>│</span>
    <a href="javascript:location.reload();">새로고침</a>
    <span class='menu_divide'>│</span>
    <a th:href="@{/score/list_by_scoreno_search_paging}">목록</a>
  </aside>
  
  <div class='menu_line'></div>
  
  <form name="frm" method="post" th:object="${scoreVO}" th:action="@{/score/create}" enctype="multipart/form-data">
    <input type="hidden" name="memberno" th:value="${scoreVO?.memberno ?: 1}">
   
    <div>
    	<label>평점</label>
    	<div style="display: flex; align-items: center; flex-direction: column; width: 300px;">
            <!-- 별모양 평점 표시 -->
            <div id="starRating" style="display: flex; justify-content: center;">
                <span class="star" data-value="1">&#9733;</span>
                <span class="star" data-value="2">&#9733;</span>
                <span class="star" data-value="3">&#9733;</span>
                <span class="star" data-value="4">&#9733;</span>
                <span class="star" data-value="5">&#9733;</span>
            </div>
            <span id="scoreValue">0</span> <!-- 선택된 평점 값 표시 -->
            <input type="hidden" name="jumsu" id="scoreInput" value="0"> <!-- 숨겨진 필드에 평점 값 저장 -->
        </div>
	</div>
	
    <div class="content_body_bottom">
        <button type="submit" class="btn btn-secondary btn-sm">등록</button>
        <button type="button" th:attr="onclick=|location.href='/score/list_by_scoreno_search_paging'|"
                class="btn btn-secondary btn-sm">목록</button>
    </div>
  </form>

  <script>
    const stars = document.querySelectorAll('.star');
    const scoreValue = document.getElementById('scoreValue');
    const scoreInput = document.getElementById('scoreInput');

    // 별 클릭 시 평점 설정
    stars.forEach(star => {
      star.addEventListener('mouseover', function() {
        const value = this.getAttribute('data-value');
        updateStars(value);
      });

      star.addEventListener('click', function() {
        const value = this.getAttribute('data-value');
        scoreInput.value = value; // 선택된 평점 값을 숨겨진 필드에 저장
        scoreValue.textContent = value; // 선택된 평점 값 표시
      });

      // 마우스가 별에서 벗어날 때
      star.addEventListener('mouseout', function() {
        const selectedValue = scoreInput.value;
        updateStars(selectedValue);
      });
    });

    // 별 모양 업데이트 함수
    function updateStars(value) {
      stars.forEach(star => {
        const starValue = star.getAttribute('data-value');
        if (starValue <= value) {
          star.style.color = '#ffcc00'; // 선택된 별은 노란색
        } else {
          star.style.color = '#ddd'; // 선택되지 않은 별은 회색
        }
      });
    }
  </script>

</div>
</html>
